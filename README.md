<div align="center">
  <h1>:fork_and_knife: AIå†·è”µåº«</h1>
  <h3>
    :star: elchika 2023å¹´SPRESENSEæ´»ç”¨ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ æŠ•ç¨¿ä½œå“
    <a href="https://elchika.com/promotion/spresense2023/conditions/">
      <img alt="elchika spresense contest" title="elchika spresense contest" src="https://img.shields.io/badge/contest page-blue.svg?logo=data:image/svg%2bxml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEiIHdpZHRoPSI2MDAiIGhlaWdodD0iNjAwIj48cGF0aCBkPSJNMTI5IDExMWMtNTUgNC05MyA2Ni05MyA3OEwwIDM5OGMtMiA3MCAzNiA5MiA2OSA5MWgxYzc5IDAgODctNTcgMTMwLTEyOGgyMDFjNDMgNzEgNTAgMTI4IDEyOSAxMjhoMWMzMyAxIDcxLTIxIDY5LTkxbC0zNi0yMDljMC0xMi00MC03OC05OC03OGgtMTBjLTYzIDAtOTIgMzUtOTIgNDJIMjM2YzAtNy0yOS00Mi05Mi00MmgtMTV6IiBmaWxsPSIjZmZmIi8+PC9zdmc+"/>
    </a>
    :star:
  </h3>
  <div style="text-align: center;">
    <img alt="ai refrigerator" title="ai refrigerator" src="https://github.com/konikoni428/ai_refrigerator/assets/61688218/eede05ea-bf4c-415e-9616-882c3882f410"/>
  </div>
</div>




## ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¬é–‹ã‚µã‚¤ãƒˆ](#ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¬é–‹ã‚µã‚¤ãƒˆ)
3. [ä½¿ã„æ–¹](#ä½¿ã„æ–¹)
4. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
5. [ä½¿ç”¨ã—ãŸéƒ¨å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹](#ä½¿ç”¨ã—ãŸéƒ¨å“ã‚µãƒ¼ãƒ“ã‚¹)
6. [é–‹ç™ºã«ä½¿ç”¨ã—ãŸãƒ„ãƒ¼ãƒ«](#é–‹ç™ºã«ä½¿ç”¨ã—ãŸãƒ„ãƒ¼ãƒ«)
7. [ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°](#ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°)
    1. [Spresense](#spresense)
    2. [GS2200 WiFi Addonãƒœãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰](#gs2200-wifi-addonãƒœãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰)
    3. [Web APP](#web-app)
8. [ãƒ¢ãƒ‡ãƒªãƒ³ã‚°](#ãƒ¢ãƒ‡ãƒªãƒ³ã‚°)
9. [å…¨ã¦ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰](#å…¨ã¦ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰)

## æ¦‚è¦
ç§ãŸã¡ã¯ã‚½ãƒ‹ãƒ¼ã®é–‹ç™ºã—ãŸãƒœãƒ¼ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã€ŒSPRESENSEã€ã‚’æ´»ç”¨ã—ã€å†·è”µåº«å‘ã‘ã®ã‚¹ãƒãƒ¼ãƒˆã‚»ãƒ³ã‚·ãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ã‚’ä½œæˆã—ã¾ã—ãŸã€‚
ã“ã®ãƒ‡ãƒã‚¤ã‚¹ã¯ã€å†·è”µåº«å†…ã®é£Ÿæã®åœ¨åº«çŠ¶æ³ã‚’ã‚«ãƒ¡ãƒ©ã«ã‚ˆã£ã¦ã‚»ãƒ³ã‚·ãƒ³ã‚°ã—ã€å®šæœŸçš„ã«ã‚µãƒ¼ãƒãƒ¼ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤–å‡ºå…ˆã‹ã‚‰ã§ã‚‚å†·è”µåº«ã®å†…å®¹ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

ã•ã‚‰ã«ã€ç”»åƒèªè­˜æ©Ÿèƒ½ã‚’å‚™ãˆãŸå¯¾è©±å‹AIãƒ¢ãƒ‡ãƒ«GPT-4ã¨ã®é€£æºã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚»ãƒ³ã‚·ãƒ³ã‚°ã•ã‚ŒãŸç”»åƒã‚’ç”¨ã„ã¦ã‚µãƒ¼ãƒãƒ¼ä¸Šã§ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¨å¯¾è©±ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å†·è”µåº«å†…ã®é£Ÿæã‚’åŸºã«ã—ãŸãƒ¬ã‚·ãƒ”æ¨è–¦ã‚„ã€ç‰¹å®šã®æ–™ç†ã‚’ä½œã‚‹éš›ã«è¿½åŠ ã§å¿…è¦ãªé£Ÿæã®ææ¡ˆãªã©ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¹…åºƒã„ãƒ‹ãƒ¼ã‚ºã«å¿œãˆã‚‹ã“ã¨ãŒå¯èƒ½ã ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚

## ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¬é–‹ã‚µã‚¤ãƒˆ

![app link](https://img.shields.io/badge/Vercel-app-blue.svg?logo=vercel)

> [!important]
> Githubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€OpenAIã®å¯¾è©±ãƒ¢ãƒ‡ãƒ«GPT4VãŒåˆ©ç”¨å¯èƒ½ãªAPI KeyãŒå¿…è¦ã§ã™

## ä½¿ã„æ–¹

1. **[ğŸŒWeb]** ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹

    Github ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã£ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™

2.  **[ğŸŒWeb]** GPT4VãŒåˆ©ç”¨å¯èƒ½ãªAPIã‚­ãƒ¼ã®å…¥åŠ›

    ![ChatGPTKey](https://camo.elchika.com/e367574bf7ccc7854955afba0ecb6d249cc25ad0/687474703a2f2f73746f726167652e676f6f676c65617069732e636f6d2f656c6368696b612f76312f757365722f64373561346230352d363236332d343366342d393261322d6534363062343865656336312f64643730306266332d326232392d343563632d393464632d326536336238336236623538/)

    OpenAIã®API Keyã¯[ã“ã¡ã‚‰ã®ãƒªãƒ³ã‚¯](https://platform.openai.com/api-keys)ã‚ˆã‚Šå–å¾—å¯èƒ½ã§ã™

3.  **[ğŸŒWeb]** Spresenseã®ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”¨APIã‚­ãƒ¼ã‚’ç™ºè¡Œã™ã‚‹

    å·¦ä¸Šã«ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨API Keyã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã®ã§ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™

    ![APIKEYå–å¾—](https://camo.elchika.com/82899d75a48ed7e69c093e441056dc085d806697/687474703a2f2f73746f726167652e676f6f676c65617069732e636f6d2f656c6368696b612f76312f757365722f64373561346230352d363236332d343366342d393261322d6534363062343865656336312f38653333333862352d383538382d346639342d623338322d333261663132323938306630/)

4.  **[ğŸŒWeb]** Regenerateã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦API Keyã‚’ç™ºè¡Œã™ã‚‹

    ![APIKeyç™ºè¡Œ](https://camo.elchika.com/07573c0d2ff7f93328a54beaa5143e8a054a094f/687474703a2f2f73746f726167652e676f6f676c65617069732e636f6d2f656c6368696b612f76312f757365722f64373561346230352d363236332d343366342d393261322d6534363062343865656336312f39366664306339352d343862612d346136392d626639342d633564346465633337333332/)

5. **[ğŸ“ŸSpresense]** Spresenseã®`config.h`ã‚’ç·¨é›†ã—ã¦æ›¸ãè¾¼ã¿

    ç·¨é›†ã™ã¹ãå¤‰æ•°ã¯ä»¥ä¸‹ã®3ã¤ã§ã™ã€‚
    `AP_SSID`ã¨`PASSPHRASE`ã«ã¯ã€Spresenseã‚’æ¥ç¶šã™ã‚‹WiFiã®SSIDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã€`HTTP_AUTH_KEY`ã«ã¯Step4ã§ä½œæˆã—ãŸOpenAI APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
    ```cpp
    #define  AP_SSID        "your-ssid"
    #define  PASSPHRASE     "your-password"

    #define  HTTP_AUTH_KEY  "Bearer <YOUR API KEY>"
    ```

6. **[ğŸ“ŸSpresense]** å‹•ã‹ã—ã¦ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

   å®Ÿè¡Œï¼ï¼

8. **[ğŸŒWeb]** ç”»åƒã‚’é¸æŠã—ã¦ãƒãƒ£ãƒƒãƒˆã™ã‚‹

    ãƒãƒ£ãƒƒãƒˆæ¬„ã®å·¦å´ã«ï¼‹ãƒœã‚¿ãƒ³ãŒã‚ã‚Šã€ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ç”»åƒé¸æŠãŒå¯èƒ½ã§ã™ã€‚
    è©¦é¨“ç”¨ã«PCã‹ã‚‰ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚‚å¯èƒ½ã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
    ï¼ˆVercel Blobã®åˆ¶ç´„ã®ãŸã‚100kBç¨‹åº¦ã®ç”»åƒã‚’é€ã£ã¦ã„ãŸã ã‘ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ï¼‰

    ![ç”»åƒé¸æŠ](https://camo.elchika.com/026ac370f5dd5bedf187152d85e256e82a2e8907/687474703a2f2f73746f726167652e676f6f676c65617069732e636f6d2f656c6368696b612f76312f757365722f64373561346230352d363236332d343366342d393261322d6534363062343865656336312f32366536373333652d343466332d343265322d616339382d373565623939343861303065/)

    ![ãƒãƒ£ãƒƒãƒˆå…¥åŠ›](https://camo.elchika.com/db7410c9c6290e73ef5f8b91e135a542531652c7/687474703a2f2f73746f726167652e676f6f676c65617069732e636f6d2f656c6368696b612f76312f757365722f64373561346230352d363236332d343366342d393261322d6534363062343865656336312f63663733323935372d386534322d343965312d393835612d623939346534336434333537/) 

    ![å›ç­”](https://camo.elchika.com/ae25d637d8c0e4994c6315f35f77514aee9867b0/687474703a2f2f73746f726167652e676f6f676c65617069732e636f6d2f656c6368696b612f76312f757365722f64373561346230352d363236332d343366342d393261322d6534363062343865656336312f32316530656465382d616437342d343930342d393233362d623364646631663530396565/)

## ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆã«ãªã£ã¦ã„ã¾ã™ã€‚
![image](https://github.com/konikoni428/ai_refrigerator/assets/57473877/a9356cf4-a5e1-418d-b9b2-7a3ed76dcae6)

## ä½¿ç”¨ã—ãŸéƒ¨å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹
- SPRESENSEãƒ¡ã‚¤ãƒ³ãƒœãƒ¼ãƒ‰
  - SPRESENSEã®åŸºç¤ã¨ãªã‚‹ãƒœãƒ¼ãƒ‰ã§ã™ã€‚
- SPRESENSEæ‹¡å¼µãƒœãƒ¼ãƒ‰
  - SDã‚«ãƒ¼ãƒ‰ã®æŒ¿å…¥ã‚„éŸ³å£°ã®I/OãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹æ‹¡å¼µã‚¢ã‚¿ãƒƒãƒãƒ¡ãƒ³ãƒˆ
- SPRESENSE HDRã‚«ãƒ¡ãƒ©ãƒœãƒ¼ãƒ‰
  - SPRESENSEãƒ¡ã‚¤ãƒ³ãƒœãƒ¼ãƒ‰ã«ã¤ãªãã“ã¨ã§æ’®å½±ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹æ‹¡å¼µã‚¢ã‚¿ãƒƒãƒãƒ¡ãƒ³ãƒˆ
- SPRESENSE Wi-Fi Add-onãƒœãƒ¼ãƒ‰ (GS2200-WiFi)
  - SPRESENSEãƒ¡ã‚¤ãƒ³ãƒœãƒ¼ãƒ‰ã«ã¤ãªãã“ã¨ã§Wifié€šä¿¡ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹æ‹¡å¼µã‚¢ã‚¿ãƒƒãƒãƒ¡ãƒ³ãƒˆ
- SDã‚«ãƒ¼ãƒ‰
  - SPRESENSEæ‹¡å¼µãƒœãƒ¼ãƒ‰ã«æŒ¿å…¥ã™ã‚‹ã“ã¨ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹
- React + Next.js
  - Web Appä½œæˆã®ãŸã‚
- Vercel + Vercel KV + Vercel Blob
  - ä½œæˆã—ãŸWebAppã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚„ã€ãƒ‡ãƒ¼ã‚¿ä¿ç®¡ã®ãŸã‚
- PLAãƒ•ã‚£ãƒ©ãƒ¡ãƒ³ãƒˆ
  - SPRESENSEã‚’å›ºå®šã™ã‚‹ãŸã‚ã®ã‚±ãƒ¼ã‚¹ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ç´ æ
  
## é–‹ç™ºã«ä½¿ç”¨ã—ãŸãƒ„ãƒ¼ãƒ«
- Arduino IDE
  - SPRESENSEä¸Šã§å‹•ä½œã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼†SPRESENSEã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- (ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«ä½¿ç”¨ã—ãŸã‚‚ã®ã®è¨˜è¼‰ãŠé¡˜ã„ã—ã¾ã™)
- Sindoh 3DWOX 2X 3D Printer
  - ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ãŸã‚±ãƒ¼ã‚¹ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã®3D Printer
- Fusion360
  - ã‚±ãƒ¼ã‚¹ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ã‚¨ãƒ‡ã‚£ã‚¿

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

### Spresense

#### GS2200 WiFi Addonãƒœãƒ¼ãƒ‰ã‚’ç”¨ã„ãŸç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
å…¬å¼ã‚ˆã‚Šæä¾›ã•ã‚Œã¦ã„ã‚‹[Arduinoãƒ©ã‚¤ãƒ–ãƒ©ãƒª](https://github.com/jittermaster/GS2200-WiFi)ã‚’ã‚‚ã¡ã„ã¦POSTé€šä¿¡ã‚’ä½¿ã„ã‚µãƒ¼ãƒãƒ¼ã«ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚

åˆã‚ã¯ãªã‹ãªã‹ã†ã¾ãã„ã‹ãªã‹ã£ãŸã®ã§ã™ãŒã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’çœºã‚ã¦ã„ã‚‹ã¨`strlen(body)`ã§ã¯ç”»åƒãƒã‚¤ãƒŠãƒªã¯æ­£ã—ãé€ä¿¡ã™ã‚‹ã‚µã‚¤ã‚ºã®è¨ˆç®—ãŒè¡Œãˆãªã„ã“ã¨ã«æ°—ã¥ãã¾ã—ãŸã€‚

```cpp:src/HttpGs2200.cpp
bool HttpGs2200::post(const char* url_path, const char* body) {
	bool result = false;

	HTTP_DEBUG("POST Start");
	result = connect();

	WiFi_InitESCBuffer();

	HTTP_DEBUG("Socket Open");
	result = send(HTTP_METHOD_POST, 10, url_path, body, strlen(body));

	return result;
}
```

ãã®ãŸã‚ã€SDã‚«ãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒã‚’èª­ã¿è¾¼ã‚“ã§ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹éš›ã«ã¯POSTé–¢æ•°ã‚’ä½¿ç”¨ã›ãšã€POSTé–¢æ•°ã¨åŒç­‰ãªé–¢æ•°ã‹ã¤ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’æ¸¡ã™ã“ã¨ãŒå¯èƒ½ãªé–¢æ•°ã‚’`custom_post`é–¢æ•°ã¨ã—ã¦å®šç¾©ã™ã‚‹ã“ã¨ã§å•é¡Œã®å›é¿ã‚’è¡Œã„ã¾ã—ãŸã€‚

```cpp:upload.ino
/* ---------------------------------------------------------------------
* Function to send byte data to the HTTP server
* ----------------------------------------------------------------------
*/
bool custom_post(const char *url_path, const char *body, uint32_t size) {
  char size_string[10];
  snprintf(size_string, sizeof(size_string), "%d", size);
  theHttpGs2200.config(HTTP_HEADER_CONTENT_LENGTH, size_string);
  Serial.println("Size");
  Serial.println(size_string);

  bool result = false;
  result = theHttpGs2200.connect();
  WiFi_InitESCBuffer();
  result = theHttpGs2200.send(HTTP_METHOD_POST, 10, url_path, body, size);
  return result;
}


void uploadImage(char *filename) {
  // Create body
  File file = theSD.open(filename, FILE_READ);
  // Calculate size in byte
  uint32_t file_size = file.size();

  // Define_a body pointer having the continuous memory space with size `file_size`
  char *body = (char *)malloc(file_size);
  if (body == NULL) {
    Serial.println("No free memory");
  }

  // Read byte of the file iteratively and put it in the address where each member of body pointer points out
  int index = 0;
  while (file.available()) {
    body[index++] = file.read();
  }
  file.close();

  // Send the body data to the server
  bool result = custom_post(HTTP_POST_PATH, body, file_size);
  if (false == result) {
    Serial.println("Post Failed");
  }
  free(body);
}
```

ãªãŠä½™è«‡ã§ã™ãŒã€ä¸€èˆ¬çš„ã«Webã§åˆ©ç”¨ã•ã‚Œã‚‹`multipart/form-data`ã‚’ä½¿ç”¨ã—ãŸç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«æŒ‘æˆ¦ã—ã¦ã„ãŸã®ã§ã™ãŒã€ã¾ã£ãŸãã†ã¾ãã„ã‹ãªã‹ã£ãŸã®ã§ã€æˆåŠŸã—ãŸæ–¹ã¯æ•™ãˆã¦ã„ãŸã ããŸã„ã§ã™ã€‚

ã¾ãŸã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å…ˆã«Vercelã«ã¦ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚’æŒ‡å®šã—ã€HTTPSã«ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†ã“ã¨ã«æŒ‘æˆ¦ã—ã¾ã—ãŸãŒã€ãƒ«ãƒ¼ãƒˆè¨¼æ˜æ›¸ã‚’å…¥ã‚Œã¦ã‚‚æ­£ã—ãã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚RSA4096bitã§è¨¼æ˜æ›¸ã®ã‚µã‚¤ã‚ºãŒå¤§ãã„ã“ã¨ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãŒã‹ã‹ã‚‹ã“ã¨ãŒåŸå› ã ã¨è€ƒãˆã¦ã„ã¾ã™ãŒã€GS2200ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå´ã§å•é¡Œã«ãªã£ã¦ãã†ãªã¨ã“ã‚ã‚’ä¿®æ­£ã—ã¦ã‚‚æ”¹å–„ã—ã¾ã›ã‚“ã§ã—ãŸã€‚

ãã®ãŸã‚å›é¿ç­–ã¨ã—ã¦Vercelã®HTTPSã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—ã¦ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹HTTPã‚µãƒ¼ãƒã‚’ç«‹ã¦ã‚‹ã“ã¨ã§å›é¿ã—ã¾ã—ãŸã€‚
ã‚‚ã¡ã‚ã‚“ä½•ã‚‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ã«è‰¯ããªã„æ§‹æˆã¨ãªã£ã¦ã„ã‚‹ãŸã‚ã€ä¿®æ­£ã—ãŸã„ã®ã§ã™ãŒã©ã†ã«ã‚‚ã§ããšã€æ”¹å–„ã§ããŸæ–¹ã¯æ•™ãˆã¦ã„ãŸã ããŸã„ã§ã™ã€‚     

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚   http    â”‚              â”‚ https  â”‚                 â”‚
â”‚  Spserense  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  HTTP Proxy  â”‚ â”€â”€â”€â”€â”€â”€â–ºâ”‚  Vercel Server  â”‚
â”‚             â”‚           â”‚              â”‚        â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã¡ãªã¿ã«ãƒ—ãƒ­ã‚­ã‚·ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªnginxè¨­å®šã‚’ç”¨ã„ã¾ã—ãŸã€‚
```nginx.conf
server {
    server_name ai-refrigerator.konikoni428.com;
    listen 80;
    listen [::]:80;
    charset UTF-8;

    location / {
        proxy_pass_request_headers off;
        proxy_set_header Host ai-refrigerator.vercel.app;
        proxy_set_header Authorization $http_authorization;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_pass https://ai-refrigerator.vercel.app;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_buffering off;
        chunked_transfer_encoding off;
        client_max_body_size 10m;
    }
}
```

### Web APP
ãƒãƒ£ãƒƒãƒˆç”»é¢ã«ã¯

- React
- Next.js

ã‚’ç”¨ã„ã¦é–‹ç™ºã‚’è¡Œã„ã¾ã—ãŸã€‚

ã¾ãŸWebã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã®ãŸã‚ã€Nextjsã®é–‹ç™ºå…ƒã§ã‚ã‚‹[Vercelç¤¾](https://vercel.com/)ã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã—ã¾ã—ãŸ
æ¯”è¼ƒçš„ç„¡æ–™ã§ä½¿ãˆã‚‹æ ãŒå¤§ãã„ã®ã§ä»Šå›ã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’å…¬é–‹ã™ã‚‹ã«ã¯éå¸¸ã«åˆ©ç”¨ã—ã‚„ã™ã„ã§ã™ã€‚

ã¾ãŸã€ChatGPTã®ã‚ˆã†ãªç”»é¢ã‚’ä½œã‚‹ã«ã‚ãŸã£ã¦[ai-chatbot](https://github.com/vercel/ai-chatbot)ã¨ã„ã†Next.jsã®é–‹ç™ºå…ƒã§ã‚ã‚‹Vercelç¤¾ãŒå‡ºã—ã¦ã„ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚’ãƒ™ãƒ¼ã‚¹ã«é–‹ç™ºã‚’è¡Œã„ã¾ã—ãŸã€‚

ã™ã¹ã¦ã®èª¬æ˜ã¯ã‚³ãƒ¼ãƒ‰é‡ã‹ã‚‰é›£ã—ã„ãŸã‚ã€ä¸»ã«Spresenseã‹ã‚‰ç”»åƒã‚’å—ã‘å–ã‚‹æ‰€ã«é–¢ä¿‚ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ç´¹ä»‹ã„ãŸã—ã¾ã™ã€‚

ã¾ãšã€ã“ã®AI å†·è”µåº« WebAppã¯ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ãŒå­˜åœ¨ã—ã¾ã™ã€‚ãã®ãŸã‚ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã¯èª°ãŒç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸã®ã‹è­˜åˆ¥ã™ã‚‹ãŸã‚ã«APIKeyã‚’ç”¨ã„ãŸèªè¨¼ã‚’è¡Œã„ã¾ã™ã€‚

APIã‚’ç™ºè¡Œã™ã‚‹å‡¦ç†ã¯ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚
`registerApiKey()`ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§APIKeyãŒç™ºè¡Œã•ã‚Œã¾ã™ã€‚
æœ¬WebAppã¯Githubã‚’ç”¨ã„ãŸãƒ­ã‚°ã‚¤ãƒ³é€£æºãŒå¯èƒ½ã¨ãªã£ã¦ãŠã‚Šã€ãã®å‡¦ç†ã¯[NextAuth.js](https://next-auth.js.org/)ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚  
ãã®éš›ã€[Vercel KV](https://vercel.com/docs/storage/vercel-kv)ã¨å‘¼ã°ã‚Œã‚‹Redisäº’æ›ã®NoSQLã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã—ã¦APIKeyã¨userIdã®é–¢é€£ä»˜ã‘ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ¼ãƒãƒ¼å´ã«ä¿ç®¡ã—ã¾ã™ã€‚

```typescript:app/actions.ts
import { kv } from '@vercel/kv'
import { auth } from '@/auth'

const generateRandomString = (length: number) => {
  const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let randomString = '';
  
  for (let i = 0; i < length; i++) {
    const randomIndex = Math.floor(Math.random() * characters.length);
    randomString += characters.charAt(randomIndex);
  }
  
  return randomString;
};


export async function registerApiKey() {
  const session = await auth()
  const userId = session?.user.id

  if (!userId) {
    return {
      error: 'Unauthorized'
    }
  }

  try{
    // remove old key
    const oldApiKey = await kv.get<string>(`user:apiKey:${userId}`);
    await kv.set(`apiKey:${oldApiKey}`, "");
  } catch (error) {
    console.log("No old api key")
  }

  const newApiKey = generateRandomString(16)

  try {
    await kv.set(`user:apiKey:${userId}`, newApiKey);
    await kv.set(`apiKey:${newApiKey}`, userId);
    return {
      apiKey: newApiKey
    }
  } catch (error) {
    // Handle errors
    return {
      error: "Register Failed"
    }
  }
}
```

ã“ã“ã‹ã‚‰ã¯å®Ÿéš›ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã®å‡¦ç†ã¨ãªã£ã¦ã„ã¾ã™ã€‚
Next.jsã«ã¯AppRoutingã¨å‘¼ã°ã‚Œã‚‹æ©Ÿèƒ½ãŒã‚ã‚Šã€appãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆãŒãã®ã¾ã¾APIã«å¤‰æ›ã•ã‚Œã€ã“ã®ä¾‹ã§ã¯ https://<example.com>/api/uploadã«å¯¾ã—ã¦ã€POSTã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã¾ã™ã€‚  

ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå±Šãã¨ã¾ãšåˆã‚ã«èªè¨¼ãŒè¡Œã‚ã‚Œã€`Authorization: Bearer <API KEY>`ã®ã‚ˆã†ã«Authorizationãƒ˜ãƒƒãƒ€ã«å…ˆã»ã©ä½œæˆã—ãŸAPIKeyã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã§èªè¨¼ãŒè¡Œã‚ã‚Œã¾ã™ã€‚
å•é¡Œãªãèªè¨¼ãŒè¡Œã‚ã‚Œã‚‹ã¨ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‹ã‚‰ç”»åƒã‚’å–ã‚Šå‡ºã—ã€[Vercel Blob](https://vercel.com/docs/storage/vercel-blob)ã¨ã„ã†ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã«ä¿ç®¡ã—ã¦ã„ã¾ã™ã€‚

```typescript:api/upload/route.ts
import { kv } from '@vercel/kv'
import { put } from '@vercel/blob';

export const runtime = 'edge'

const generateRandomString = (length: number) => {
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let randomString = '';
    
    for (let i = 0; i < length; i++) {
      const randomIndex = Math.floor(Math.random() * characters.length);
      randomString += characters.charAt(randomIndex);
    }
    
    return randomString;
};


export async function POST(req: Request) {
  const authorizationHeader = req.headers.get('Authorization')

  if (!authorizationHeader || !authorizationHeader.startsWith('Bearer ')) {
    return new Response('Bad request. You need to set Authorization header with Bearer token', {
        status: 400,
    })
  }
  const apiKey = authorizationHeader.split('Bearer ')[1]
  
  const userId = await kv.get<string>(`apiKey:${apiKey}`)
  if (!userId || userId.length === 0) {
    return new Response('Bad api key', {
      status: 401
    })
  }

  const imageData = req.body
  if (!imageData) {
    return new Response('Bad request', {
        status: 400
    })
  }

  const date = new Date()
  const filename = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}_${generateRandomString(8)}.jpg`;

  const blob = await put(`${userId}/${filename}`, imageData, {
    access: 'public',
  });

  return new Response('Success', {
    status: 200
  })
}
```

## ãƒ¢ãƒ‡ãƒªãƒ³ã‚°

ã‚ˆã‚Šå†·è”µåº«å†…ã®é£Ÿæã‚’æ­£ç¢ºã«æŠŠæ¡ã§ãã‚‹ã‚ˆã†ã«ã€å„ç’°å¢ƒï¼ˆå†·è”µåº«ï¼‰ã«åˆã‚ã›ã¦ã€è¨­å–¶å ´æ‰€ãƒ»ã‚«ãƒ¡ãƒ©è§’åº¦ã‚’å¤‰ãˆã‚Œã‚‹ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã—ã¾ã—ãŸã€‚
è§’åº¦èª¿æ•´éƒ¨ã¯[ã“ã¡ã‚‰ã®ãƒœãƒ¼ãƒ«ã‚¸ãƒ§ã‚¤ãƒ³ãƒˆã‚’](https://www.thingiverse.com/thing:1156296)ã€SPRESENSEå›ºå®šéƒ¨ã¯[å…¬å¼githubã‚’](https://github.com/sonydevworld/spresense-hw-design-files/blob/master/Case/LTE-Board-Case-Sample/stl/LTE-Board-Case-Sample_bottom.stl)ã‚’å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚

ï¼ˆå‚è€ƒã«ã—ãŸè§’åº¦èª¿æ•´éƒ¨ï¼ˆå·¦ï¼‰å‚è€ƒã«ã—ãŸSPRESENSEå›ºå®šéƒ¨ï¼ˆå³ï¼‰ï¼‰
![image](https://github.com/konikoni428/ai_refrigerator/assets/57473877/a83bdedd-f847-471d-a218-7552a32f99f2)


ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ã¯Fusion360ã‚’ã€ãƒ—ãƒªãƒ³ãƒˆã«ã¯Sindoh 3DWOX 2X 3D Printerã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚
å®Ÿéš›ã®ãƒ¢ãƒ‡ãƒ«ãƒ‡ãƒ¼ã‚¿ã¯[github](https://github.com/konikoni428/ai_refrigerator/tree/main/case_model)ã«ç½®ã„ã¦ã„ã¾ã™ã€‚



ï¼ˆåˆ¶ä½œã—ãŸåœŸå°éƒ¨åˆ†ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆå·¦ï¼‰åˆ¶ä½œã—ãŸSPRESENSEå›ºå®šéƒ¨ï¼ˆå³ï¼‰ï¼‰
![image](https://github.com/konikoni428/ai_refrigerator/assets/57473877/334046a5-85cf-4033-892c-0d0d59c04983)




ï¼ˆãƒœãƒ¼ãƒ«éƒ¨åˆ†ã«ã‚ˆã£ã¦è§’åº¦èª¿æ•´ãŒå¯èƒ½ï¼ˆå·¦ãƒ»ä¸­å¤®ï¼‰ã€‚å®Ÿéš›ã«SPRESENSEã‚’ãƒã‚¦ãƒ³ãƒˆã—ã¦æ’®å½±ã—ã¦ã„ã‚‹æ§˜å­ï¼ˆå³ï¼‰ï¼‰
![image](https://github.com/konikoni428/ai_refrigerator/assets/57473877/82997fa5-8081-4f26-9235-28d0a7cb1811)


ã¯ã˜ã‚ã¦ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã§ã‚¸ãƒ§ã‚¤ãƒ³ãƒˆéƒ¨åˆ†ãŒã¡ã‚ƒã‚“ã¨æ©Ÿèƒ½ã™ã‚‹ã‹å¿ƒé…ã§ã—ãŸãŒã€ãã‚Œã„ã«å‡ºåŠ›ï¼†æ©Ÿèƒ½ã•ã‚Œã¾ã—ãŸï¼

## å…¨ã¦ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

Elchikaã«ã®ã¿è¨˜å…¥



